From 12baf41eefa8093fd9880169c330e69468b41d91 Mon Sep 17 00:00:00 2001
From: Devin AI <158243242+devin-ai-integration[bot]@users.noreply.github.com>
Date: Mon, 22 Dec 2025 11:41:52 +0000
Subject: [PATCH] fix: add explicit permissions to workflow files for
 GITHUB_TOKEN

- Add permissions block to all Upptime workflows (contents: write, issues: write, actions: write)
- Replace workflow-dispatch step in setup.yml with direct graphs generation
- This allows workflows to work without a PAT when repo has read/write workflow permissions enabled

Co-Authored-By: mailsurajzso7+000095i349qo@gmail.com <mailsurajzso7@gmail.com>
---
 .github/workflows/graphs.yml        |  3 +++
 .github/workflows/response-time.yml |  4 ++++
 .github/workflows/setup.yml         | 12 +++++++++---
 .github/workflows/site.yml          |  3 +++
 .github/workflows/summary.yml       |  3 +++
 .github/workflows/uptime.yml        |  4 ++++
 6 files changed, 26 insertions(+), 3 deletions(-)

diff --git a/.github/workflows/graphs.yml b/.github/workflows/graphs.yml
index 39120a0..5387948 100644
--- a/.github/workflows/graphs.yml
+++ b/.github/workflows/graphs.yml
@@ -20,6 +20,9 @@ on:
     types: [graphs]
   workflow_dispatch:
 
+permissions:
+  contents: write
+
 jobs:
   release:
     name: Generate graphs
diff --git a/.github/workflows/response-time.yml b/.github/workflows/response-time.yml
index 8609c84..2ea6b41 100644
--- a/.github/workflows/response-time.yml
+++ b/.github/workflows/response-time.yml
@@ -20,6 +20,10 @@ on:
     types: [response_time]
   workflow_dispatch:
 
+permissions:
+  contents: write
+  issues: write
+
 jobs:
   release:
     name: Check status
diff --git a/.github/workflows/setup.yml b/.github/workflows/setup.yml
index f76254b..82bd8e6 100644
--- a/.github/workflows/setup.yml
+++ b/.github/workflows/setup.yml
@@ -21,6 +21,11 @@ on:
     types: [setup]
   workflow_dispatch:
 
+permissions:
+  contents: write
+  issues: write
+  actions: write
+
 jobs:
   release:
     name: Setup Upptime
@@ -51,10 +56,11 @@ jobs:
         env:
           GH_PAT: ${{ secrets.GH_PAT || github.token }}
       - name: Generate graphs
-        uses: benc-uk/workflow-dispatch@v1
+        uses: upptime/uptime-monitor@v1.41.0
         with:
-          workflow: Graphs CI
-          token: ${{ secrets.GH_PAT || github.token }}
+          command: "graphs"
+        env:
+          GH_PAT: ${{ secrets.GH_PAT || github.token }}
       - name: Generate site
         uses: upptime/uptime-monitor@v1.41.0
         with:
diff --git a/.github/workflows/site.yml b/.github/workflows/site.yml
index 9e5f089..166ab06 100644
--- a/.github/workflows/site.yml
+++ b/.github/workflows/site.yml
@@ -20,6 +20,9 @@ on:
     types: [static_site]
   workflow_dispatch:
 
+permissions:
+  contents: write
+
 jobs:
   release:
     name: Build and deploy site
diff --git a/.github/workflows/summary.yml b/.github/workflows/summary.yml
index 76d552b..fbf6b67 100644
--- a/.github/workflows/summary.yml
+++ b/.github/workflows/summary.yml
@@ -20,6 +20,9 @@ on:
     types: [summary]
   workflow_dispatch:
 
+permissions:
+  contents: write
+
 jobs:
   release:
     name: Generate README
diff --git a/.github/workflows/uptime.yml b/.github/workflows/uptime.yml
index 03757a0..2785493 100644
--- a/.github/workflows/uptime.yml
+++ b/.github/workflows/uptime.yml
@@ -20,6 +20,10 @@ on:
     types: [uptime]
   workflow_dispatch:
 
+permissions:
+  contents: write
+  issues: write
+
 jobs:
   release:
     name: Check status
-- 
2.34.1

