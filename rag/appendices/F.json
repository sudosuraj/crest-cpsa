{
  "title": "Appendix F: Unix Security Assessment",
  "letter": "F",
  "content": "Appendix F: Unix Security Assessment\nF1 User enumeration\nDiscovery of valid usernames from network services commonly running by default:\nrusers\nrwho\nSMTP\nfinger\nUnderstand how finger daemon derives the information that it returns, and hence how it can be abused.\nThe discovery of valid usernames from network services like rusers, rwho, SMTP, and finger can be\nconsidered as part of information gathering or enumeration during the reconnaissance phase of security\nassessments. These services may reveal user-related information, which can be valuable for an attacker\ntrying to understand the target network.\n1. rusers and rwho:\n• rusers (Remote Users):\n• This service provides a list of users who are currently logged into the remote system.\n• Command: rusers\n• rwho (Remote Who):\n• Similar to rusers, it displays information about users currently logged into the remote\nsystem.\n• Command: rwho\n2. SMTP (Simple Mail Transfer Protocol):\n• SMTP Enumeration:\n• Enumerating user accounts through SMTP involves querying the mail server for valid\nuser accounts.\n• Techniques may include using the VRFY and EXPN commands:\n• VRFY <username>: Verifies the existence of a user.\n• EXPN <mailing list>: Expands a mailing list.\n3. finger:\n• Finger Daemon:\n• The finger service allows users to query information about users on a remote system.\n• Command: finger <username>@[host]\n• Finger daemon retrieves information from the /etc/passwd file or a similar user\ndatabase.\n• Abuse of Finger Daemon:\n• Finger service, when misconfigured or overly permissive, can leak sensitive information\nsuch as usernames, full names, and possibly other details.\n• Attackers may use it for username enumeration by querying for existing usernames.\n\nF2 Unix vulnerabilities\nRecent or commonly found Solaris vulnerabilities, and in particular those for which there is exploit code\nin the public domain.\nUse of remote exploit code and local exploit code to gain root access to target host\nCommon post exploitation activities:\nexfiltrate password hashes\ncrack password hashes\ncheck patch levels\nderive list of missing security patches\nreversion to previous state\nSolaris Vulnerabilities\nAuthor's Notes: Couldn't find any that is generic enough to put in here... :(\nLinux Vulnerabilities\n• Dirty Cow kernel exploit\nGenerally, if the kernel version is 3+, it is definitely vulnerable to some kernel exploits\nExfiltrate password hashes & crack\nLinux password files.\n/etc/passwd\n/etc/shadow\nOnce we have these 2, it may be possible to do wordlist attacks, or bruteforce.\nCheck patch levels\nuname -a\nDerive list of missing security patches\nAuthor's Notes: Each flavour or distribution have their own package managers. Each handle updating\ndifferently.\nFor example, Debian or Ubuntu with APT package manager:\nAPT command\n\ndescription\n\napt list --upgradable\n\nList all updates available\n\napt list --upgradable grep \"-security\"\n\nList all updates that are security.\n\nTaken from: learnsomemore, https://askubuntu.com/questions/774805/how-to-get-a-list-of-allpending-security-updates\nreversion to previous state\nSolaris reverting snapshots https://docs.oracle.com/cd/E36784_01/html/E36820/revertsnap.html\n• svcadm restart manifest-import\n• svcadm refresh\n• svccfg refresh\nLinux does not have a default \"System Restore\" function. There are packages that can help with this.\n\nF3 File Transfer Protocol(FTP)\nFTP access control Anonymous access to FTP servers Risks of allowing write access to anonymous users.\nFTP Bounce Attack\nFTP bounce attack is an exploit of the FTP protocol whereby an attacker is able to use the PORT\ncommand to request access to ports indirectly through the use of the victim machine, which serves as a\nproxy for the request, similar to an Open mail relay using SMTP.\nThis technique can be used to port scan hosts discreetly, and to potentially bypass a network Accesscontrol list to access specific ports that the attacker cannot access through a direct connection, for\nexample with the nmap port scanner.\nNearly all modern FTP server programs are configured by default to refuse PORT commands that would\nconnect to any host but the originating host, thwarting FTP bounce attacks.\nSource: https://en.wikipedia.org/wiki/FTP_bounce_attack\nFTP Access Control\nUses username and password. Possible to set ftp-specific user, and deny other users from logging in. We\ncan also set home folders for FTP, so that they cannot look at our whole system files.\nhttps://linuxroutes.com/create-ftp-user-with-specific-directory-access/\nImportantly, we need to disable shell access for the FTP user.\nusermod -s /sbin/nologin ftpuser\nEven if the ftpuser password is leaked, attackers cannot SSH in through the ftpuser.\nAnonymous access to FTP servers\nLogin:\nftp <target_ip>\npftp <target_ip>\n# this is in passive mode\nCredentials:\nUsername: anonymous\nPassword: anonymous\nRisks of allowing write access to anonymous users.\nIf the directory is linked to a php website, we can upload a php file and achieve code execution.\nIt depends on what the intention of the FTP server, and on you to figure out an attack vector based on\nfile upload from FTP service.\nFTP commands:\nget filename.txt\nput filename.txt\nIf we fail to put a file, that means we do not have write access. It may be worth it to check if we can\nwrite to other directories.\n\nF4 Sendmail/ SMTP\nValid username discovery via EXPN and VRFY Awareness of recent Sendmail vulnerabilities; ability to\nexploit them if possible Mail relaying\nHosts need SMTPd running.\nBanner Grabbing\nnc -vn <target_ip> 25\nFinding Information\nHELO\nVRFY root\nEXPN root\n\n# or HELO x\n# will check if this user in system or not.\n# will check user and may reveal email address\n\nAuto enumeration\nnmap --script smtp-enum-users <target_ip>\nRecent vulnerabilities\nMail Relaying\nOften used in the cloud to help businesses send mass emails, overcoming SMTP limits set by providers\netc. https://blog.mailchannels.com/what-is-an-smtp-relay-service\n\nF5 Network File System(NFS)\nNFS security: host level (exports restricted to particular hosts) and file level (by UID and GID).\nRoot squashing, nosuid and noexec options.\nFile access through UID and GID manipulation.\nNFS is used for file sharing in a network. Generally, we can mount a folder onto our local machine, and\nhave shared functions\nEnumerating shares\nshowmount -e <target_ip>\nMounting onto our local machine\nhttps://linuxize.com/post/how-to-mount-an-nfs-share-in-linux/\nsudo mount -t nfs target_ip:/home/myuser/backups /var/backups -nolock\nunmounting the share\numount 10.10.0.10:/home/myuser/backups\nOR\numount /var/backups\nHere, we are mounting the remote user's backup folder into our local machine's /var/backups folder.\nAutomatic mounting can be done with /etc/fstab\nNFS security by GID, UID\nGID and UID are group id and user id. id id command will show current users id.\nOn the NFS server machine, some files may be restricted to certain UID or GIDs.\nLaunching attack\nCASE: A file has the following read permissions: UID=1103\nWhen we mount it, we need similar permissions to access it. We can add a new user into our attacker\nmachine with the UID of 1103\nAdd a user.\nsudo useradd -u 1103 tempuser\nChange the user's password\nsudo passwd tempuser\nChange user of the terminal to tempuser\nsu tempuser\nTry and access the file.\nIf a file needs root, we can change to our own root user to access it. The same process goes for GID.\nRoot Squashing\nRoot squash is a special mapping of the remote superuser (root) identity when using identity\nauthentication (local user is the same as remote user). Under root squash, a client's uid 0 (root) is\nmapped to 65534 (nobody). It is primarily a feature of NFS but may be available on other systems as\nwell.\nRoot squash is a technique to avoid privilege escalation on the client machine via suid executables\nSetuid. Without root squash, an attacker can generate suid binaries on the server that are executed as\nroot on other client, even if the client user does not have superuser privileges. Hence it protects client\nmachines against other malicious clients.\n\nF6 Berkeley R* Service (Berkeley r-commands)\nhttps://en.wikipedia.org/wiki/Berkeley_r-commands\nBerkeley r* service:\n• access control (/etc/hosts.equiv and .rhosts)\n• trust relationships Impact of poorly-configured trust relationships.\nBerkeley r-commands is a suite created 1981 for sending remote commands from one Unix computer to\nanother. It is not in use today, however, we may still see some or its services, such as rlogin, running in\nCTFs or labs.\nCommands\n• rlogin - remote login\n• rsh - remote shell. This is a server, does not require login.\n• rexec - remote execute. This is a server, requires login.\n• rcp - remote copy\n• rwho - remote who\n• rstat - rstat returns performance statistics from the kernel.\n• ruptime - shows how long it has been since last restart. If not response, computer marked as\ndown.\nThose r-commands which involve user authentication (rcp, rexec, rlogin, and rsh) share several serious\nsecurity vulnerabilities:\n• All information, including passwords, is transmitted unencrypted (making it vulnerable to\ninterception).\n• The .rlogin (or .rhosts) file is easy to misuse. They are designed to allow logins without a\npassword, but their reliance on remote usernames, hostnames, and IP addresses is exploitable.\nFor this reason many corporate system administrators prohibit .rhosts files, and actively\nscrutinize their networks for offenders.\n• The protocol partly relies on the remote party's rlogin client to provide information honestly,\nincluding source port and source host name. A corrupt client is thus able to forge this and gain\naccess, as the rlogin protocol has no means of authenticating other machines' identities, or\nensuring that the requesting client on a trusted machine is the real rlogin client.\n• The common practice of mounting users' home directories via NFS exposes rlogin to attack by\nmeans of fake .rhosts files - this means that any of NFS's security faults automatically plague\nrlogin.\nDue to these problems, the r-commands fell into relative disuse (with many Unix and Linux distributions\nno longer including them by default). Many networks that formerly relied on rlogin and telnet have\nreplaced them with SSH and its rlogin-equivalent slogin.\nSource: https://en.wikipedia.org/wiki/Berkeley_r-commands#Security\n\nF7 X11 - X Windowing systom common in Unix-like OSes\nX Windows security and configuration; host-based vs. user-based access control. (NOT MICROSOFT\nWINDOWS) https://www.x.org/wiki/ https://en.wikipedia.org/wiki/X_Window_authorization Manual\npage: https://www.x.org/archive/current/doc/man/man1/Xserver.1.xhtml\nIt is a GUI system.\nUser-based access control.\n$ xhost +SI:localuser:anotheruser\nlocaluser:anotheruser being added to access control list\nCheck for successful addition with\nxhost\nFor remote users, we may need something like SUN-DES-1 and MIT-KERBEROS-5 identitiy management\nsystems.\nHost-based\nhttps://www.ibm.com/docs/en/aix/7.1?topic=concerns-enabling-disabling-access-control\nxhost + hostname\nHostname is taken from /etc/hosts\nFatal error\nxhost +\nWithout a host name, this will allow all hosts. If the server is open to internet, then it is of course\nextremely vulnerable.\n\nF8 Remote Procedure Call(RPC) Services\nhttps://en.wikipedia.org/wiki/Remote_procedure_call RPC service enumeration Common RPC services\nRecent or commonly-found RPC service vulnerabilities.\nAllows for client to execute procedures on a remote machine. NFS is a prominent user of RPC.\nRPC service enumeration\nRPC Tools: https://resources.oreilly.com/examples/9780596510305/tree/master/tools/rpctools\nnmap -sV --script=nfs-* <target_ip>\nrpbind -p <target_ip>\nrpcinfo -p <target_ip>\nrpcclient --I <target_ip>\nrpcdump [-p port] <target_ip>\nCommon RPC services\n• NFS\n• SMB2\n• MSRPC\n\nF9 Secure Shell(SSH)\nIdentify the types and versions of SSH software in use Securing SSH Versions 1 and 2 of the SSH protocol\nAuthentication mechanisms within SSH\nBanner Grabbing\nhttps://github.com/jtesta/ssh-audit nc -vn <target_IP> 22 ssh-audit.py [-1246pbcnjvlt]\n<host>\nSecuring SSH\nhttps://linux.die.net/man/5/sshd_config\nTurn off root login\nvi /etc/ssh/sshd_config Change PermitRootLogin to no PermitRootLogin no restart SSH\nserver /etc/init.d/sshd restart\nDisable empty passwords\nvi /etc/ssh/sshd_config Change PermitEmptyPasswords to no PermitEmptyPasswords no\nTurn off password login\nvi /etc/ssh/sshd_config Change PasswordAuthentication to no PasswordAuthentication no\nThis will mean that we have to login using a private key file. If the key is leaked, change it immediately.\nSet number of login tries to prevent login\nvi /etc/ssh/sshd_config MaxAuthTries 3\nMaxAuthTries Specifies the maximum number of authentication attempts permitted per connection.\nOnce the number of failures reaches half this value, additional failures are logged. The default is 6.\nProtection tools\nhttps://www.sshguard.net/ https://www.fail2ban.org/wiki/index.php/Main_Page\nThese are log monitoring and response tools.\nChanging port number?\nWhile we can change SSH port to somgthing like port 9999(where the default is port 22), it is still weak\nto targetted attacks.\nTools like shodan can scan for port 22 services on the internet.\nHowever, security via obscurity is not reliable and largely discouraged.",
  "sections": [
    {
      "id": "F1",
      "title": "F1 User enumeration",
      "content": "F1 User enumeration\nDiscovery of valid usernames from network services commonly running by default:\nrusers\nrwho\nSMTP\nfinger\nUnderstand how finger daemon derives the information that it returns, and hence how it can be abused.\nThe discovery of valid usernames from network services like rusers, rwho, SMTP, and finger can be\nconsidered as part of information gathering or enumeration during the reconnaissance phase of security\nassessments. These services may reveal user-related information, which can be valuable for an attacker\ntrying to understand the target network.\n1. rusers and rwho:\n• rusers (Remote Users):\n• This service provides a list of users who are currently logged into the remote system.\n• Command: rusers\n• rwho (Remote Who):\n• Similar to rusers, it displays information about users currently logged into the remote\nsystem.\n• Command: rwho\n2. SMTP (Simple Mail Transfer Protocol):\n• SMTP Enumeration:\n• Enumerating user accounts through SMTP involves querying the mail server for valid\nuser accounts.\n• Techniques may include using the VRFY and EXPN commands:\n• VRFY <username>: Verifies the existence of a user.\n• EXPN <mailing list>: Expands a mailing list.\n3. finger:\n• Finger Daemon:\n• The finger service allows users to query information about users on a remote system.\n• Command: finger <username>@[host]\n• Finger daemon retrieves information from the /etc/passwd file or a similar user\ndatabase.\n• Abuse of Finger Daemon:\n• Finger service, when misconfigured or overly permissive, can leak sensitive information\nsuch as usernames, full names, and possibly other details.\n• Attackers may use it for username enumeration by querying for existing usernames."
    },
    {
      "id": "F2",
      "title": "F2 Unix vulnerabilities",
      "content": "F2 Unix vulnerabilities\nRecent or commonly found Solaris vulnerabilities, and in particular those for which there is exploit code\nin the public domain.\nUse of remote exploit code and local exploit code to gain root access to target host\nCommon post exploitation activities:\nexfiltrate password hashes\ncrack password hashes\ncheck patch levels\nderive list of missing security patches\nreversion to previous state\nSolaris Vulnerabilities\nAuthor's Notes: Couldn't find any that is generic enough to put in here... :(\nLinux Vulnerabilities\n• Dirty Cow kernel exploit\nGenerally, if the kernel version is 3+, it is definitely vulnerable to some kernel exploits\nExfiltrate password hashes & crack\nLinux password files.\n/etc/passwd\n/etc/shadow\nOnce we have these 2, it may be possible to do wordlist attacks, or bruteforce.\nCheck patch levels\nuname -a\nDerive list of missing security patches\nAuthor's Notes: Each flavour or distribution have their own package managers. Each handle updating\ndifferently.\nFor example, Debian or Ubuntu with APT package manager:\nAPT command\n\ndescription\n\napt list --upgradable\n\nList all updates available\n\napt list --upgradable grep \"-security\"\n\nList all updates that are security.\n\nTaken from: learnsomemore, https://askubuntu.com/questions/774805/how-to-get-a-list-of-allpending-security-updates\nreversion to previous state\nSolaris reverting snapshots https://docs.oracle.com/cd/E36784_01/html/E36820/revertsnap.html\n• svcadm restart manifest-import\n• svcadm refresh\n• svccfg refresh\nLinux does not have a default \"System Restore\" function. There are packages that can help with this."
    },
    {
      "id": "F3",
      "title": "F3 File Transfer Protocol(FTP)",
      "content": "F3 File Transfer Protocol(FTP)\nFTP access control Anonymous access to FTP servers Risks of allowing write access to anonymous users.\nFTP Bounce Attack\nFTP bounce attack is an exploit of the FTP protocol whereby an attacker is able to use the PORT\ncommand to request access to ports indirectly through the use of the victim machine, which serves as a\nproxy for the request, similar to an Open mail relay using SMTP.\nThis technique can be used to port scan hosts discreetly, and to potentially bypass a network Accesscontrol list to access specific ports that the attacker cannot access through a direct connection, for\nexample with the nmap port scanner.\nNearly all modern FTP server programs are configured by default to refuse PORT commands that would\nconnect to any host but the originating host, thwarting FTP bounce attacks.\nSource: https://en.wikipedia.org/wiki/FTP_bounce_attack\nFTP Access Control\nUses username and password. Possible to set ftp-specific user, and deny other users from logging in. We\ncan also set home folders for FTP, so that they cannot look at our whole system files.\nhttps://linuxroutes.com/create-ftp-user-with-specific-directory-access/\nImportantly, we need to disable shell access for the FTP user.\nusermod -s /sbin/nologin ftpuser\nEven if the ftpuser password is leaked, attackers cannot SSH in through the ftpuser.\nAnonymous access to FTP servers\nLogin:\nftp <target_ip>\npftp <target_ip>\n# this is in passive mode\nCredentials:\nUsername: anonymous\nPassword: anonymous\nRisks of allowing write access to anonymous users.\nIf the directory is linked to a php website, we can upload a php file and achieve code execution.\nIt depends on what the intention of the FTP server, and on you to figure out an attack vector based on\nfile upload from FTP service.\nFTP commands:\nget filename.txt\nput filename.txt\nIf we fail to put a file, that means we do not have write access. It may be worth it to check if we can\nwrite to other directories."
    },
    {
      "id": "F4",
      "title": "F4 Sendmail/ SMTP",
      "content": "F4 Sendmail/ SMTP\nValid username discovery via EXPN and VRFY Awareness of recent Sendmail vulnerabilities; ability to\nexploit them if possible Mail relaying\nHosts need SMTPd running.\nBanner Grabbing\nnc -vn <target_ip> 25\nFinding Information\nHELO\nVRFY root\nEXPN root\n\n# or HELO x\n# will check if this user in system or not.\n# will check user and may reveal email address\n\nAuto enumeration\nnmap --script smtp-enum-users <target_ip>\nRecent vulnerabilities\nMail Relaying\nOften used in the cloud to help businesses send mass emails, overcoming SMTP limits set by providers\netc. https://blog.mailchannels.com/what-is-an-smtp-relay-service"
    },
    {
      "id": "F5",
      "title": "F5 Network File System(NFS)",
      "content": "F5 Network File System(NFS)\nNFS security: host level (exports restricted to particular hosts) and file level (by UID and GID).\nRoot squashing, nosuid and noexec options.\nFile access through UID and GID manipulation.\nNFS is used for file sharing in a network. Generally, we can mount a folder onto our local machine, and\nhave shared functions\nEnumerating shares\nshowmount -e <target_ip>\nMounting onto our local machine\nhttps://linuxize.com/post/how-to-mount-an-nfs-share-in-linux/\nsudo mount -t nfs target_ip:/home/myuser/backups /var/backups -nolock\nunmounting the share\numount 10.10.0.10:/home/myuser/backups\nOR\numount /var/backups\nHere, we are mounting the remote user's backup folder into our local machine's /var/backups folder.\nAutomatic mounting can be done with /etc/fstab\nNFS security by GID, UID\nGID and UID are group id and user id. id id command will show current users id.\nOn the NFS server machine, some files may be restricted to certain UID or GIDs.\nLaunching attack\nCASE: A file has the following read permissions: UID=1103\nWhen we mount it, we need similar permissions to access it. We can add a new user into our attacker\nmachine with the UID of 1103\nAdd a user.\nsudo useradd -u 1103 tempuser\nChange the user's password\nsudo passwd tempuser\nChange user of the terminal to tempuser\nsu tempuser\nTry and access the file.\nIf a file needs root, we can change to our own root user to access it. The same process goes for GID.\nRoot Squashing\nRoot squash is a special mapping of the remote superuser (root) identity when using identity\nauthentication (local user is the same as remote user). Under root squash, a client's uid 0 (root) is\nmapped to 65534 (nobody). It is primarily a feature of NFS but may be available on other systems as\nwell.\nRoot squash is a technique to avoid privilege escalation on the client machine via suid executables\nSetuid. Without root squash, an attacker can generate suid binaries on the server that are executed as\nroot on other client, even if the client user does not have superuser privileges. Hence it protects client\nmachines against other malicious clients."
    },
    {
      "id": "F6",
      "title": "F6 Berkeley R* Service (Berkeley r-commands)",
      "content": "F6 Berkeley R* Service (Berkeley r-commands)\nhttps://en.wikipedia.org/wiki/Berkeley_r-commands\nBerkeley r* service:\n• access control (/etc/hosts.equiv and .rhosts)\n• trust relationships Impact of poorly-configured trust relationships.\nBerkeley r-commands is a suite created 1981 for sending remote commands from one Unix computer to\nanother. It is not in use today, however, we may still see some or its services, such as rlogin, running in\nCTFs or labs.\nCommands\n• rlogin - remote login\n• rsh - remote shell. This is a server, does not require login.\n• rexec - remote execute. This is a server, requires login.\n• rcp - remote copy\n• rwho - remote who\n• rstat - rstat returns performance statistics from the kernel.\n• ruptime - shows how long it has been since last restart. If not response, computer marked as\ndown.\nThose r-commands which involve user authentication (rcp, rexec, rlogin, and rsh) share several serious\nsecurity vulnerabilities:\n• All information, including passwords, is transmitted unencrypted (making it vulnerable to\ninterception).\n• The .rlogin (or .rhosts) file is easy to misuse. They are designed to allow logins without a\npassword, but their reliance on remote usernames, hostnames, and IP addresses is exploitable.\nFor this reason many corporate system administrators prohibit .rhosts files, and actively\nscrutinize their networks for offenders.\n• The protocol partly relies on the remote party's rlogin client to provide information honestly,\nincluding source port and source host name. A corrupt client is thus able to forge this and gain\naccess, as the rlogin protocol has no means of authenticating other machines' identities, or\nensuring that the requesting client on a trusted machine is the real rlogin client.\n• The common practice of mounting users' home directories via NFS exposes rlogin to attack by\nmeans of fake .rhosts files - this means that any of NFS's security faults automatically plague\nrlogin.\nDue to these problems, the r-commands fell into relative disuse (with many Unix and Linux distributions\nno longer including them by default). Many networks that formerly relied on rlogin and telnet have\nreplaced them with SSH and its rlogin-equivalent slogin.\nSource: https://en.wikipedia.org/wiki/Berkeley_r-commands#Security"
    },
    {
      "id": "F7",
      "title": "F7 X11 - X Windowing systom common in Unix-like OSes",
      "content": "F7 X11 - X Windowing systom common in Unix-like OSes\nX Windows security and configuration; host-based vs. user-based access control. (NOT MICROSOFT\nWINDOWS) https://www.x.org/wiki/ https://en.wikipedia.org/wiki/X_Window_authorization Manual\npage: https://www.x.org/archive/current/doc/man/man1/Xserver.1.xhtml\nIt is a GUI system.\nUser-based access control.\n$ xhost +SI:localuser:anotheruser\nlocaluser:anotheruser being added to access control list\nCheck for successful addition with\nxhost\nFor remote users, we may need something like SUN-DES-1 and MIT-KERBEROS-5 identitiy management\nsystems.\nHost-based\nhttps://www.ibm.com/docs/en/aix/7.1?topic=concerns-enabling-disabling-access-control\nxhost + hostname\nHostname is taken from /etc/hosts\nFatal error\nxhost +\nWithout a host name, this will allow all hosts. If the server is open to internet, then it is of course\nextremely vulnerable."
    },
    {
      "id": "F8",
      "title": "F8 Remote Procedure Call(RPC) Services",
      "content": "F8 Remote Procedure Call(RPC) Services\nhttps://en.wikipedia.org/wiki/Remote_procedure_call RPC service enumeration Common RPC services\nRecent or commonly-found RPC service vulnerabilities.\nAllows for client to execute procedures on a remote machine. NFS is a prominent user of RPC.\nRPC service enumeration\nRPC Tools: https://resources.oreilly.com/examples/9780596510305/tree/master/tools/rpctools\nnmap -sV --script=nfs-* <target_ip>\nrpbind -p <target_ip>\nrpcinfo -p <target_ip>\nrpcclient --I <target_ip>\nrpcdump [-p port] <target_ip>\nCommon RPC services\n• NFS\n• SMB2\n• MSRPC"
    },
    {
      "id": "F9",
      "title": "F9 Secure Shell(SSH)",
      "content": "F9 Secure Shell(SSH)\nIdentify the types and versions of SSH software in use Securing SSH Versions 1 and 2 of the SSH protocol\nAuthentication mechanisms within SSH\nBanner Grabbing\nhttps://github.com/jtesta/ssh-audit nc -vn <target_IP> 22 ssh-audit.py [-1246pbcnjvlt]\n<host>\nSecuring SSH\nhttps://linux.die.net/man/5/sshd_config\nTurn off root login\nvi /etc/ssh/sshd_config Change PermitRootLogin to no PermitRootLogin no restart SSH\nserver /etc/init.d/sshd restart\nDisable empty passwords\nvi /etc/ssh/sshd_config Change PermitEmptyPasswords to no PermitEmptyPasswords no\nTurn off password login\nvi /etc/ssh/sshd_config Change PasswordAuthentication to no PasswordAuthentication no\nThis will mean that we have to login using a private key file. If the key is leaked, change it immediately.\nSet number of login tries to prevent login\nvi /etc/ssh/sshd_config MaxAuthTries 3\nMaxAuthTries Specifies the maximum number of authentication attempts permitted per connection.\nOnce the number of failures reaches half this value, additional failures are logged. The default is 6.\nProtection tools\nhttps://www.sshguard.net/ https://www.fail2ban.org/wiki/index.php/Main_Page\nThese are log monitoring and response tools.\nChanging port number?\nWhile we can change SSH port to somgthing like port 9999(where the default is port 22), it is still weak\nto targetted attacks.\nTools like shodan can scan for port 22 services on the internet.\nHowever, security via obscurity is not reliable and largely discouraged."
    }
  ]
}